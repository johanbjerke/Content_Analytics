[sseanalytics]
action.email.useNSSubject = 1
action.keyindicator.invert = 0
action.makestreams.param.verbose = 0
action.nbtstat.param.verbose = 0
action.notable.param.verbose = 0
action.nslookup.param.verbose = 0
action.ping.param.verbose = 0
action.risk.param.verbose = 0
action.threat_add.param.verbose = 0
alert.track = 0
cron_schedule = 0 6 * * 1
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.custom.sankey_diagram_app.sankey_diagram.showBackwards = 0
display.visualizations.custom.sankey_diagram_app.sankey_diagram.showLabels = 1
display.visualizations.custom.sankey_diagram_app.sankey_diagram.showLegend = 1
display.visualizations.custom.sankey_diagram_app.sankey_diagram.showSelf = 0
display.visualizations.custom.sankey_diagram_app.sankey_diagram.showTooltip = 1
display.visualizations.custom.sankey_diagram_app.sankey_diagram.styleBackwards = 0
display.visualizations.custom.sankey_diagram_app.sankey_diagram.useColors = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = Splunk_Security_Essentials
request.ui_dispatch_view = search
search = | sseanalytics\
| eval detection_search=coalesce(spath(summaries, "example1.object.value") ,spath(summaries, "example0.object.value"))\
| eval hasSearch=spath(summaries, "hasSearch") \
| eval includeSSE=spath(summaries, "includeSSE") \
| eval datasource=spath(summaries, "datasource") \
| eval displayapp=spath(summaries, "displayapp") \
| eval app=spath(summaries, "app") \
| eval journey=spath(summaries, "journey") \
| eval category=spath(summaries, "category") \
| eval domain=spath(summaries, "domain") \
| eval name=spath(summaries, "name") \
| eval icon=spath(summaries, "icon") \
| eval description=spath(summaries, "description") \
| eval dashboard=spath(summaries, "dashboard") \
| eval mitre=spath(summaries, "mitre") \
| eval killchain=spath(summaries, "killchain") \
| eval cis=spath(summaries, "cis") \
| eval alertvolume=spath(summaries, "alertvolume") \
| eval highlight=spath(summaries, "highlight") \
| eval SPLEase=spath(summaries, "SPLEase") \
| eval includeSSE=spath(summaries, "includeSSE") \
| eval bookmark_status=spath(summaries, "bookmark_status") \
| eval bookmark_user=spath(summaries, "bookmark_user") \
| eval usecase=spath(summaries, "usecase") \
| eval released=spath(summaries, "released") \
| foreach category datasourc* killchain mitre usecase \
    [| makemv <<FIELD>> delim="|" ] \
| eval usecase=mvdedup(usecase)\
| table detection_search name usecase hasSearch includeSSE datasource displayapp app journey category domain icon description dashboard mitre killchain cis alertvolume bookmark_status\
| table name displayapp app\
| rename name AS "Use Case"

[Generate Sourcetype Summary - Scheduled]
action.email.useNSSubject = 1
action.keyindicator.invert = 0
action.makestreams.param.verbose = 0
action.nbtstat.param.verbose = 0
action.notable.param.verbose = 0
action.nslookup.param.verbose = 0
action.ping.param.verbose = 0
action.risk.param.verbose = 0
action.threat_add.param.verbose = 0
alert.track = 0
cron_schedule = 0 1 * * *
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.custom.sankey_diagram_app.sankey_diagram.showBackwards = 0
display.visualizations.custom.sankey_diagram_app.sankey_diagram.showLabels = 1
display.visualizations.custom.sankey_diagram_app.sankey_diagram.showLegend = 1
display.visualizations.custom.sankey_diagram_app.sankey_diagram.showSelf = 0
display.visualizations.custom.sankey_diagram_app.sankey_diagram.showTooltip = 1
display.visualizations.custom.sankey_diagram_app.sankey_diagram.styleBackwards = 0
display.visualizations.custom.sankey_diagram_app.sankey_diagram.useColors = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = DataSourceOverview
request.ui_dispatch_view = search
search = | rest splunk_server=local count=0 /servicesNS/-/-/admin/sourcetypes \
| rename eai:acl.app AS app tags AS tag_name\
| table app title\
| sort app title\
| rename title AS Sourcetype\
|join type=outer Sourcetype [\
\
| tstats count WHERE index=* earliest=-24h BY sourcetype\
| rename sourcetype AS Sourcetype, count AS sourcetype_count_24h\
\
]\
| eval sourcetype_count_24h=coalesce(sourcetype_count_24h,0)\
| eval sourcetype_origin="installed"\
| table Sourcetype app sourcetype_origin sourcetype_count_24h\
| outputlookup Installed_sourcetypes.csv
